<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤£ H-CODE Humor Quiz - What's Your Comedy DNA? ğŸ§¬</title>
    
    <!-- Google Fonts for fun typography -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&family=Comic+Neue:wght@300;400;700&family=Bungee:wght@400&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Fun font families */
        .font-fun {
            font-family: 'Fredoka', cursive;
        }
        .font-comic {
            font-family: 'Comic Neue', cursive;
        }
        .font-bungee {
            font-family: 'Bungee', cursive;
        }
        
        /* Custom styles for progress bars with rainbow gradients! */
        .progress-bar {
            transition: width 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7, #fd79a8);
            background-size: 300% 300%;
            animation: rainbow-slide 3s ease infinite;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);
        }
        
        @keyframes rainbow-slide {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Bouncy fade-in animations */
        .fade-in {
            animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes bounceIn {
            0% { 
                opacity: 0; 
                transform: scale(0.3) translateY(50px) rotate(-5deg); 
            }
            50% {
                opacity: 0.7;
                transform: scale(1.1) translateY(-10px) rotate(2deg);
            }
            100% { 
                opacity: 1; 
                transform: scale(1) translateY(0) rotate(0deg); 
            }
        }
        
        /* Fun hover effects - only on non-critical interactive elements */
        .wiggle-decoration:hover {
            animation: wiggle 0.5s ease-in-out;
        }
        
        /* Gentle hover for buttons instead of wiggle */
        .button-hover:hover {
            transform: translateY(-2px);
            transition: transform 0.2s ease;
        }
        
        @keyframes wiggle {
            0%, 7% { transform: rotateZ(0deg); }
            15% { transform: rotateZ(-15deg); }
            20% { transform: rotateZ(10deg); }
            25% { transform: rotateZ(-10deg); }
            30% { transform: rotateZ(6deg); }
            35% { transform: rotateZ(-4deg); }
            40%, 100% { transform: rotateZ(0deg); }
        }
        
        /* Pulsing glow effect */
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes pulseGlow {
            from {
                box-shadow: 0 0 10px #ff6b6b, 0 0 20px #ff6b6b, 0 0 30px #ff6b6b;
            }
            to {
                box-shadow: 0 0 5px #4ecdc4, 0 0 15px #4ecdc4, 0 0 25px #4ecdc4;
            }
        }
        
        /* Floating emoji animation */
        .float {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        /* Fun gradient backgrounds */
        .bg-fun-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .bg-party-gradient {
            background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
        }
        
        .bg-joke-gradient {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        
        .quiz-transition {
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* Confetti-like background pattern */
        body::before {
            content: "ğŸ‰ ğŸ˜‚ ğŸ¤£ ğŸ˜† ğŸ­ ğŸƒ ğŸª âœ¨ ğŸŒŸ ğŸ’«";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.05;
            font-size: 30px;
            z-index: -1;
            animation: float 4s ease-in-out infinite;
            pointer-events: none;
        }

    /* Respect system reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after { animation: none !important; transition: none !important; }
    }

    /* Manual reduced motion toggle */
    .reduce-motion *, .reduce-motion *::before, .reduce-motion *::after {
      animation: none !important;
      transition: none !important;
    }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
  // App version (update this when making notable changes)
  const APP_VERSION = "v0.3.0"; // update as you ship changes

  // Simple icon components (no external dependencies)
        const CheckIcon = () => React.createElement('svg', {
            width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'
        }, React.createElement('path', { d: 'm9 12 2 2 4-4' }));

        const ArrowRightIcon = () => React.createElement('svg', {
            width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'
        }, React.createElement('path', { d: 'M5 12h14' }), React.createElement('path', { d: 'l7-7 7 7-7 7' }));

        const RotateCcwIcon = () => React.createElement('svg', {
            width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'
        }, React.createElement('path', { d: 'M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8' }), React.createElement('path', { d: 'M3 3v5h5' }));

        const Share2Icon = () => React.createElement('svg', {
            width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'
        }, React.createElement('circle', { cx: 18, cy: 5, r: 3 }), React.createElement('circle', { cx: 6, cy: 12, r: 3 }), React.createElement('circle', { cx: 18, cy: 19, r: 3 }), React.createElement('path', { d: 'M8.59 13.51l6.83 3.98' }), React.createElement('path', { d: 'M15.41 6.51l-6.82 3.98' }));

        // Use React hooks
        const { useMemo, useState, useEffect } = React;

        // Your quiz data and logic (copied from your component file)
        const ITEMS = [
          // Axis 1 â€” Target Orientation (S vs O)
          { id: 1, axis: "Target", pole: "S", text: "I often make myself the butt of the joke to make others feel comfortable." },
          { id: 2, axis: "Target", pole: "O", text: "I'm more likely to tease others than to poke fun at myself." },
          { id: 3, axis: "Target", pole: "S", text: "My favorite kind of humor is selfâ€‘mockery." },
          { id: 4, axis: "Target", pole: "O", text: "I enjoy humor that takes someone else down a peg." },
          { id: 5, axis: "Target", pole: "S", text: "Even in a roast, I'd rather roast myself than the other person." },
          { id: 6, axis: "Target", pole: "O", text: "The funniest jokes are about other people's quirks or mistakes." },
          // Axis 2 â€” Intent Valence (B vs C)
          { id: 7, axis: "Valence", pole: "B", text: "I like humor that makes everyone feel included." },
          { id: 8, axis: "Valence", pole: "C", text: "A sharp, cutting remark is often the funniest part of a conversation." },
          { id: 9, axis: "Valence", pole: "B", text: "I avoid humor that could make someone feel bad, even if it's funny." },
          { id: 10, axis: "Valence", pole: "C", text: "The best jokes have a bit of bite to them." },
          { id: 11, axis: "Valence", pole: "B", text: "I'm drawn to gentle, uplifting humor." },
          { id: 12, axis: "Valence", pole: "C", text: "Sarcasm is one of my favorite comedic tools." },
          // Axis 3 â€” Cognitive Style (N vs A)
          { id: 13, axis: "Cognitive", pole: "N", text: "I enjoy jokes where the punchline neatly explains the setup." },
          { id: 14, axis: "Cognitive", pole: "A", text: "The weirder and less it makes sense, the better." },
          { id: 15, axis: "Cognitive", pole: "N", text: "I like stories that build up to a clever twist ending." },
          { id: 16, axis: "Cognitive", pole: "A", text: "Random, nonsensical humor cracks me up more than logical jokes." },
          { id: 17, axis: "Cognitive", pole: "N", text: "Puns and wordplay are my kind of humor." },
          { id: 18, axis: "Cognitive", pole: "A", text: "Humor that feels like a dream sequence is my favorite." },
          // Axis 4 â€” Delivery Mode (V vs P)
          { id: 19, axis: "Delivery", pole: "V", text: "I love clever turns of phrase and witty banter." },
          { id: 20, axis: "Delivery", pole: "P", text: "I find visual gags and slapstick funnier than verbal jokes." },
          { id: 21, axis: "Delivery", pole: "V", text: "A smart oneâ€‘liner can make me laugh harder than any physical stunt." },
          { id: 22, axis: "Delivery", pole: "P", text: "A perfectly timed pratfall is comedy gold." },
          { id: 23, axis: "Delivery", pole: "V", text: "I enjoy humor that plays with language more than sight gags." },
          { id: 24, axis: "Delivery", pole: "P", text: "Facial expressions and body language make jokes funnier to me." },
        ];

        const AXES = [
          { key: "Target", letters: ["S", "O"], label: "ğŸ¯ Target Orientation", poles: { S: "Selfâ€‘directed ğŸª", O: "Otherâ€‘directed ğŸ‘¥" } },
          { key: "Valence", letters: ["B", "C"], label: "ğŸ’ Intent Valence", poles: { B: "Benevolent ğŸ¤—", C: "Critical ğŸ—¡ï¸" } },
          { key: "Cognitive", letters: ["N", "A"], label: "ğŸ§  Cognitive Style", poles: { N: "Narrativeâ€‘Resolution ğŸ“š", A: "Absurdâ€‘Incongruous ğŸ¤ª" } },
          { key: "Delivery", letters: ["V", "P"], label: "ğŸ­ Delivery Mode", poles: { V: "Verbal/Linguistic ğŸ’¬", P: "Physical/Visual ğŸ¤¸â€â™‚ï¸" } },
        ];

        const PROFILE_LIBRARY = {
          "SBNV": {
            title: "ğŸ¤— The Warm Wordsmith",
            subtitle: "Selfâ€‘deprecating, uplifting, and clever. You invite people in with wit and warmth like a comedy campfire! ğŸ”¥âœ¨",
            growth: [
              "ğŸŒ¶ï¸ Experiment with sharper or more absurd turns to expand your rangeâ€”add some spice to that sweetness!",
              "ğŸª Try playful banter that edges toward surreal without losing kindnessâ€”like being a friendly circus ringmaster!",
              "ğŸ­ Watch a contrasting style (e.g., O C A P) and borrow a single elementâ€”comedy cross-training!",
            ],
            examples: ["John Mulaney (selfâ€‘mockery master ğŸ‘¨â€ğŸ¤)", "Early Ellen monologues (pure joy ğŸ’ƒ)", "Jim Halpert's asides â€” The Office (camera wink champion ğŸ˜‰)"],
          },
          "SBNP": {
            title: "ğŸ­ The Playful Storyteller",
            subtitle: "Cozy stories with expressive faces and physical beatsâ€”you're like a human emoji! ğŸ˜„ğŸ¤¸â€â™‚ï¸",
            growth: ["ğŸ”¤ Blend in wordplay to complement physicalityâ€”be a walking, talking pun machine!", "ğŸ”„ Add callbacks for stronger narrative payoffâ€”make your stories boomerang back for extra laughs!", "ğŸ‘¥ Try lowâ€‘stakes crowd work to vary rhythmâ€”the audience is your playground!"],
            examples: ["Robin Williams (character work wizard ğŸ§™â€â™‚ï¸)", "Jack Black stage storytelling (pure energy bomb ğŸ’¥)"],
          },
          "SBAV": {
            title: "ğŸ¦„ The Absurd Linguist",
            subtitle: "Gentle, surreal wordâ€‘bending with whimsical nonsenseâ€”you speak fluent gibberish with a PhD! ğŸ“ğŸ¤ª",
            growth: ["âš“ Anchor some bits in everyday momentsâ€”make the weird feel familiar!", "ğŸ“ Use structures (rule of three) to frame the weirdâ€”organize the chaos!", "â±ï¸ Test brevity vs. build for each premiseâ€”find your perfect weird timing!"],
            examples: ["Steven Wright (deadpan master ğŸ˜)", "Demetri Martin (conceptual bits genius ğŸ§ ğŸ“Š)"],
          },
          "SBAP": {
            title: "ğŸ¤¸â€â™‚ï¸ The Goofy Improviser",
            subtitle: "Playful chaos, improv energy, and wholesome physicalityâ€”you're a human cartoon character! ğŸ¨ğŸ’«",
            growth: ["ğŸ§µ Thread miniâ€‘stories through the chaosâ€”connect your beautiful madness!", "ğŸª Introduce a recurring prop/characterâ€”give your chaos a mascot!", "â¸ï¸ Practice pauses to let laughs breatheâ€”even chaos needs oxygen!"],
            examples: ["Jim Carrey (elastic physicality god ğŸ¤¸â€â™‚ï¸)", "Melissa McCarthy (fearless pratfall queen ğŸ‘‘ğŸ’¥)"],
          },
          "SCNV": {
            title: "ğŸ—¡ï¸ The Selfâ€‘Roasting Satirist",
            subtitle: "Sharp wordplay dissecting your own flawsâ€”you're your own toughest (and funniest) critic! ğŸ”ğŸ˜",
            growth: ["ğŸ‘€ Occasionally turn the lens outwardâ€”give yourself a break from the mirror!", "âš–ï¸ Balance bite with relief linesâ€”be the yin AND yang of comedy!", "ğŸ·ï¸ Use tags to soften or escalate deliberatelyâ€”you're the volume control of your own roast!"],
            examples: ["Hannah Gadsby (reflective powerhouse ğŸ’ª)", "Tig Notaro (deadpan selfâ€‘commentary master ğŸ˜ğŸ‘‘)"],
          },
          "SCNP": {
            title: "ğŸ­ The Ironic Mime",
            subtitle: "Physical satire turned inwardâ€”you're like Charlie Chaplin having an existential crisis! ğŸ¤”ğŸª",
            growth: ["ğŸ¯ Pair big moves with precise linesâ€”be physically loud but verbally surgical!", "ğŸµ Vary tempo (fast bits vs slow burns)â€”you're conducting a comedy orchestra!", "ğŸ¤« Explore silent builds to explosive payoffâ€”master the art of comedic suspense!"],
            examples: ["Rowan Atkinson (Mr. Bean genius ğŸ§¸)", "Kristen Wiig (awkward character queen ğŸ‘‘ğŸ˜¬)"],
          },
          "SCAV": {
            title: "ğŸ–¤ The Dark Surrealist",
            subtitle: "Bizarre, critical selfâ€‘commentary with an artful edgeâ€”you're like Salvador DalÃ­ having a therapy session! ğŸ­ğŸ’­",
            growth: ["ğŸ’¡ Offer clear emotional entry pointsâ€”throw your audience a lifeline in the confusion!", "âš–ï¸ Alternate heavy themes with light palettesâ€”be the yin-yang of comedy!", "ğŸ›¡ï¸ Use metaphor to defang darker beatsâ€”wrap your darkness in pretty paper!"],
            examples: ["Maria Bamford (surreal selfâ€‘critique wizard ğŸ§™â€â™€ï¸)", "Bo Burnham (meta-comedy mastermind ğŸ¤¯)"],
          },
          "SCAP": {
            title: "ğŸ¤¡ The Punk Clown",
            subtitle: "Chaotic, selfâ€‘mocking physical comedy with a biteâ€”you're a beautiful disaster with perfect timing! ğŸ’¥ğŸª",
            growth: ["ğŸ¯ Calibrate shock to contextâ€”read the room, then shock it appropriately!", "â¸ï¸ Let a punchline sit before the next hitâ€”even chaos needs to breathe!", "âš“ Ground wild premises with a simple wantâ€”give your madness a mission!"],
            examples: ["Eric Andre (anarchic energy god âš¡)", "Sacha Baron Cohen (physical provocation master ğŸ¥¸)"],
          },
          "OBNV": {
            title: "ğŸ¤ The Friendly Raconteur",
            subtitle: "Warm, clever stories about others â€” never punching down. You're the wholesome narrator we all need! ğŸ“šâ¤ï¸",
            growth: ["ğŸŒ€ Inject occasional absurd left turnsâ€”surprise your audience with delightful detours!", "âœ‚ï¸ Trim exposition to speed to the turnâ€”get to the good stuff faster!", "ğŸ‘ï¸ Play with perspective shifts (2nd person)â€”make them part of the story!"],
            examples: ["Graham Norton (playful interview wizard ğŸ¤)", "LeVar Burton (gentle anecdote master ğŸ“–)"],
          },
          "OBNP": {
            title: "ğŸ‰ The Jolly Host",
            subtitle: "Groupâ€‘binding stories with expressive, physical momentsâ€”you're the human equivalent of a group hug! ğŸ¤—ğŸª",
            growth: ["âš¡ Test sharper angles sparinglyâ€”add just a pinch of spice!", "ğŸ”„ Use running bits across segmentsâ€”create your own inside jokes!", "ğŸ™Œ Invite audience participation for momentumâ€”make them part of the show!"],
            examples: ["Jimmy Fallon (goofy sketch king ğŸ‘‘)", "James Corden (game show energy âš¡)"],
          },
          "OBAV": {
            title: "ğŸƒ The Benevolent Trickster",
            subtitle: "Absurd premises involving others, always in good faithâ€”you're like a kind-hearted chaos wizard! ğŸ§™â€â™‚ï¸âœ¨",
            growth: ["ğŸ“š Wrap absurdity in miniâ€‘arcsâ€”give your chaos a story!", "ğŸ·ï¸ Add taglines that reframe the bitâ€”help your audience keep up!", "ğŸ­ Try improvising constraints (oneâ€‘word scenes)â€”challenge yourself creatively!"],
            examples: ["Whose Line Is It Anyway? (improv perfection ğŸ­)", "Impractical Jokers (lighthearted mischief ğŸ˜„)"]
          },
          "OBAP": {
            title: "ğŸ˜‡ The Wholesome Prankster",
            subtitle: "Playful, nonsensical physical setups that keep others safeâ€”you're Mr. Rogers with a mischievous streak! ğŸ¡ğŸª",
            growth: ["ğŸ’¬ Layer witty commentary over visualsâ€”be the narrator of your own chaos!", "ğŸ­ Use props to escalate safelyâ€”make inanimate objects your co-stars!", "ğŸ¤ Balance surprises with consent cuesâ€”keep everyone happy and laughing!"],
            examples: ["Wholesome prank channels (pure joy ğŸ˜Š)", "Mr. Rogers (gentle play master ğŸ§¸)"]
          },
          "OCNV": {
            title: "ğŸ¯ The Verbal Sniper",
            subtitle: "Razorâ€‘sharp burns aimed outward; surgical timing and phrasingâ€”you're a comedy marksman! ğŸ¹ğŸ’¥",
            growth: ["ğŸ¯ Interleave light palate cleansersâ€”sweeten the medicine!", "â¬†ï¸ Signal targets (punching up)â€”aim for the powerful, not the powerless!", "ğŸ›ï¸ Develop altâ€‘tags for different audiencesâ€”be a comedy chameleon!"],
            examples: ["Stephen Colbert (political takedown artist ğŸ­)", "Michelle Wolf (roast master ğŸ”¥)"]
          },
          "OCNP": {
            title: "ğŸ¤º The Physical Roaster",
            subtitle: "Barbed narratives amplified by bold gestures and reenactmentsâ€”you're a living, breathing cartoon villain! ğŸ­âš¡",
            growth: ["ğŸ’– Soften with benevolent beatsâ€”show your heart between the jabs!", "ğŸ“– Let gestures serve story logicâ€”make every movement meaningful!", "ğŸ“ Vary scale: microâ€‘mugging vs big pratfallsâ€”be dynamically ridiculous!"],
            examples: ["John Cleese (sketch physicality legend ğŸ¦¶)", "Roast battle reenactments (theatrical burns ğŸ­)"]
          },
          "OCAV": {
            title: "ğŸª The Madcap Cynic",
            subtitle: "Weird, biting scenarios; surreal premises with a stingâ€”you're like a fever dream with an attitude! ğŸŒ¡ï¸ğŸ˜ˆ",
            growth: ["ğŸ  Frontâ€‘load your worldviewâ€”let people into your beautiful madness!", "ğŸ­ Alternate silly with sincereâ€”be unpredictably human!", "ğŸ”— Use callâ€‘backs to reward attentive listenersâ€”create a secret club of understanding!"],
            examples: ["Monty Python (absurd critique masters ğŸ)", "Tim Minchin (satirical song genius ğŸµ)"]
          },
          "OCAP": {
            title: "ğŸ’¥ The Chaotic Provocateur",
            subtitle: "Physical chaos plus biting satire, aimed at othersâ€”you're a hurricane with a sense of humor! ğŸŒªï¸ğŸ˜‚",
            growth: ["ğŸš¦ Set boundaries to keep controlâ€”be chaotic but not destructive!", "ğŸ“ˆ Use escalation laddersâ€”build your chaos systematically!", "ğŸšª End with a release valve (benign tag)â€”give everyone a safe landing!"],
            examples: ["Boratâ€‘style interactions (fearless commitment ğŸ¤)", "Jackassâ€‘adjacent satire (controlled chaos ğŸ’¥)"]
          },
        };

        // Helper functions
        function computeScores(answers) {
          const sums = {};
          for (const axis of AXES) {
            sums[axis.key] = { [axis.letters[0]]: 0, [axis.letters[1]]: 0 };
          }

          ITEMS.forEach((item) => {
            const v = answers[item.id];
            if (!v) return;
            sums[item.axis][item.pole] += v;
          });

          const letters = [];
          const detail = {};
          AXES.forEach((axis) => {
            const [L1, L2] = axis.letters;
            const s1 = sums[axis.key][L1] || 0;
            const s2 = sums[axis.key][L2] || 0;
            const chosen = s1 >= s2 ? L1 : L2;
            letters.push(chosen);

            const min = 3, max = 15;
            const pct1 = ((s1 - min) / (max - min)) * 100;
            const pct2 = ((s2 - min) / (max - min)) * 100;

            detail[axis.key] = {
              label: axis.label,
              poles: axis.poles,
              letters: axis.letters,
              raw: { [L1]: s1, [L2]: s2 },
              pct: { [L1]: Math.max(0, Math.min(100, pct1)), [L2]: Math.max(0, Math.min(100, pct2)) },
            };
          });

          const code = letters.join("");
          return { code, detail };
        }

        // Components
        const Likert = ({ value, onChange }) => {
          // Use expressive faces (user preference) but clarify meaning with persistent text legend
          const faces = [
            { val: 1, char: 'ğŸ˜–', label: 'Strongly Disagree' },
            { val: 2, char: 'ğŸ™', label: 'Disagree' },
            { val: 3, char: 'ğŸ˜', label: 'Neutral' },
            { val: 4, char: 'ğŸ™‚', label: 'Agree' },
            { val: 5, char: 'ğŸ¤©', label: 'Strongly Agree' },
          ];

          return (
            <div className="flex flex-col items-center gap-2">
              <div className="flex gap-2 items-center" role="group" aria-label="Agreement scale">
                {faces.map((opt) => (
                  <button
                    key={opt.val}
                    onClick={() => onChange(opt.val)}
                    title={opt.label}
                    aria-label={opt.label}
                    className={`w-12 h-12 rounded-full text-2xl flex items-center justify-center transition-colors button-hover ${
                      value === opt.val
                        ? 'bg-white/30 ring-2 ring-white/70'
                        : 'bg-white/15 hover:bg-white/25'
                    }`}
                  >
                    <span aria-hidden="true">{opt.char}</span>
                  </button>
                ))}
              </div>
              {/* Persistent legend to disambiguate agreement scale */}
              <div className="w-full flex justify-between text-[11px] text-white/70 px-1 select-none">
                <span>Strongly Disagree</span>
                <span>Neutral</span>
                <span>Strongly Agree</span>
              </div>
              {value && (
                <div className="text-white/90 text-sm font-comic text-center bg-white/10 px-3 py-1 rounded-full">
                  {faces.find((f) => f.val === value)?.label}
                </div>
              )}
            </div>
          );
        };

        const ProgressBar = ({ pct }) => (
          <div className="w-full h-3 bg-gray-200 rounded-full overflow-hidden">
            <div className="h-3 rounded-full progress-bar" style={{ width: `${pct}%` }} />
          </div>
        );

        function ResultView({ code, detail, onRetake }) {
          const profile = PROFILE_LIBRARY[code] || {
            title: "ğŸ¦„ Your Unique Comedy Mix",
            subtitle: "A rare blend â€” you're one of the 3% with this exact combination! Your axis scores below reveal your comedy superpowers.",
            growth: ["ğŸ¯ Explore your lowest pole with a weekly challenge.", "ğŸ”„ Borrow a tag from your opposite axis in one bit.", "ğŸ“º Rewatch a set in your contrast style and copy 1 technique."],
            examples: ["You're blazing your own trail! ğŸ”¥"],
          };

          const opposite = useMemo(() => {
            const opp = Object.entries(detail)
              .map(([k, info]) => {
                const [L1, L2] = info.letters;
                return info.pct[L1] >= info.pct[L2] ? L2 : L1;
              })
              .join("");
            return opp;
          }, [detail]);

          // Calculate rarity and personalization
          const calculateRarity = () => {
            const combinations = 2 * 2 * 2 * 2; // 16 total combinations
            const rarityMap = {
              'SBNV': 8, 'SBNP': 12, 'SBAV': 3, 'SBAP': 15,
              'SCNV': 5, 'SCNP': 7, 'SCAV': 2, 'SCAP': 6,
              'OBNV': 18, 'OBNP': 22, 'OBAV': 4, 'OBAP': 9,
              'OCNV': 11, 'OCNP': 14, 'OCAV': 3, 'OCAP': 1
            };
            return rarityMap[code] || 5;
          };

          const rarity = calculateRarity();
          
          // Generate personalized insights based on their specific scores
          const generatePersonalizedInsights = () => {
            const insights = [];
            
            Object.entries(detail).forEach(([key, info]) => {
              const [L1, L2] = info.letters;
              const stronger = info.pct[L1] >= info.pct[L2] ? L1 : L2;
              const weaker = info.pct[L1] < info.pct[L2] ? L1 : L2;
              const gap = Math.abs(info.pct[L1] - info.pct[L2]);
              
              if (gap > 30) {
                insights.push({
                  icon: key === 'Target' ? 'ğŸ¯' : key === 'Valence' ? 'ğŸ’' : key === 'Cognitive' ? 'ğŸ§ ' : 'ğŸ­',
                  title: `Strong ${info.poles[stronger]} Tendency`,
                  text: `You scored ${Math.round(info.pct[stronger])}% ${info.poles[stronger]} vs ${Math.round(info.pct[weaker])}% ${info.poles[weaker]}. This strong preference shapes your comedic voice significantly!`
                });
              } else if (gap < 10) {
                insights.push({
                  icon: key === 'Target' ? 'âš–ï¸' : key === 'Valence' ? 'ğŸ”„' : key === 'Cognitive' ? 'ğŸ­' : 'ğŸ¤¹',
                  title: `Balanced ${info.label}`,
                  text: `You're nearly balanced (${Math.round(info.pct[L1])}% vs ${Math.round(info.pct[L2])}%). This flexibility is your comedy superpower - you can adapt to any audience!`
                });
              }
            });
            
            return insights;
          };

          const personalizedInsights = generatePersonalizedInsights();

          return (
            <div className="max-w-4xl mx-auto">
              <div className="text-center mb-10">
                <div className="text-6xl mb-4 float">ğŸ‰</div>
                <h1 className="text-5xl font-bungee text-white mb-6 drop-shadow-lg">Your Comedy DNA Revealed! ğŸ§¬</h1>
                
                {/* Rarity and Achievement */}
                <div className="bg-gradient-to-r from-yellow-400 to-orange-500 p-4 rounded-3xl mb-6 max-w-2xl mx-auto">
                  <div className="text-2xl font-bold text-black mb-2">ğŸ† Achievement Unlocked!</div>
                  <div className="text-lg font-comic text-black">
                    You're one of only {rarity}% of people with this exact comedy profile!
                  </div>
                </div>

                <div className="relative">
                  <div className="absolute inset-0 bg-gradient-to-r from-pink-400 via-purple-500 to-indigo-500 rounded-3xl blur-lg opacity-75"></div>
                  <div className="relative bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500 px-8 py-6 rounded-3xl text-white text-4xl font-bungee shadow-2xl">
                    {code.split("").join(" - ")}
                  </div>
                </div>
                <div className="mt-6 bg-white/20 backdrop-blur-sm p-6 rounded-3xl">
                  <h2 className="text-3xl font-bold text-white mb-2">{profile.title}</h2>
                  <p className="text-xl font-comic text-white/90 leading-relaxed">{profile.subtitle}</p>
                </div>
              </div>

              {/* Personalized Insights Section */}
              {personalizedInsights.length > 0 && (
                <div className="mb-10">
                  <h2 className="text-3xl font-bungee text-white mb-6 text-center">ğŸ” Your Personal Comedy Analysis</h2>
                  <div className="grid gap-4">
                    {personalizedInsights.map((insight, idx) => (
                      <div key={idx} className="p-6 rounded-3xl bg-gradient-to-r from-blue-500/20 to-purple-600/20 backdrop-blur-sm border border-white/20">
                        <div className="flex items-start gap-4">
                          <div className="text-3xl">{insight.icon}</div>
                          <div>
                            <h3 className="font-bold text-xl text-white mb-2">{insight.title}</h3>
                            <p className="text-white/90 font-comic leading-relaxed">{insight.text}</p>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {/* Detailed Axis Breakdown */}
              <div className="mb-10">
                <h2 className="text-3xl font-bungee text-white mb-6 text-center">ğŸ“Š Your Comedy Blueprint</h2>
                <div className="grid md:grid-cols-2 gap-6">
                  {Object.entries(detail).map(([key, info], idx) => {
                    const dominant = info.pct[info.letters[0]] >= info.pct[info.letters[1]] ? info.letters[0] : info.letters[1];
                    const dominantPct = Math.max(info.pct[info.letters[0]], info.pct[info.letters[1]]);
                    
                    return (
                      <div key={key} className="p-6 rounded-3xl bg-white/10 backdrop-blur-sm border border-white/20 hover:bg-white/20 transition-all wiggle" style={{animationDelay: `${idx * 0.1}s`}}>
                        <div className="flex items-center justify-between mb-4">
                          <h3 className="font-bold text-xl text-white">{info.label}</h3>
                          <span className="text-sm text-white/70 bg-white/20 px-3 py-1 rounded-full">{info.letters[0]} / {info.letters[1]}</span>
                        </div>
                        
                        {/* Show which is dominant */}
                        <div className="mb-4 p-3 bg-gradient-to-r from-green-400/20 to-blue-500/20 rounded-2xl">
                          <div className="text-white font-bold">ğŸ† Primary Style: {info.poles[dominant]}</div>
                          <div className="text-white/80 text-sm">{Math.round(dominantPct)}% strength in this area</div>
                        </div>
                        
                        <div className="space-y-4">
                          <div>
                            <div className="flex justify-between text-sm mb-2 text-white">
                              <span className="font-comic">{info.letters[0]} â€” {info.poles[info.letters[0]]}</span>
                              <span className="font-bold">{Math.round(info.pct[info.letters[0]])}% ğŸ”¥</span>
                            </div>
                            <div className="bg-white/20 rounded-full h-3 overflow-hidden">
                              <ProgressBar pct={info.pct[info.letters[0]]} />
                            </div>
                          </div>
                          <div>
                            <div className="flex justify-between text-sm mb-2 text-white">
                              <span className="font-comic">{info.letters[1]} â€” {info.poles[info.letters[1]]}</span>
                              <span className="font-bold">{Math.round(info.pct[info.letters[1]])}% ğŸ”¥</span>
                            </div>
                            <div className="bg-white/20 rounded-full h-3 overflow-hidden">
                              <ProgressBar pct={info.pct[info.letters[1]]} />
                            </div>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Actionable Next Steps */}
              <div className="mb-8">
                <h2 className="text-3xl font-bungee text-white mb-6 text-center">ğŸ¯ Your Comedy Action Plan</h2>
                <div className="grid md:grid-cols-3 gap-4">
                  <div className="p-6 rounded-3xl bg-gradient-to-br from-green-500/20 to-teal-600/20 backdrop-blur-sm border border-white/20">
                    <div className="text-3xl mb-3">ğŸ“±</div>
                    <h3 className="font-bold text-white text-lg mb-2">This Week</h3>
                    <p className="text-white/90 font-comic text-sm">
                      Try incorporating your {Object.entries(detail).find(([k,v]) => Math.max(...Object.values(v.pct)) === Math.max(...Object.entries(detail).flatMap(([_,info]) => Object.values(info.pct))))?.[1]?.poles?.[Object.entries(detail).find(([k,v]) => Math.max(...Object.values(v.pct)) === Math.max(...Object.entries(detail).flatMap(([_,info]) => Object.values(info.pct))))?.[1]?.letters?.find(l => detail[Object.entries(detail).find(([k,v]) => Math.max(...Object.values(v.pct)) === Math.max(...Object.entries(detail).flatMap(([_,info]) => Object.values(info.pct))))?.[0]]?.pct?.[l] === Math.max(...Object.values(detail[Object.entries(detail).find(([k,v]) => Math.max(...Object.values(v.pct)) === Math.max(...Object.entries(detail).flatMap(([_,info]) => Object.values(info.pct))))?.[0]]?.pct || {})))] || 'dominant'} style into 3 conversations this week.
                    </p>
                  </div>
                  <div className="p-6 rounded-3xl bg-gradient-to-br from-blue-500/20 to-indigo-600/20 backdrop-blur-sm border border-white/20">
                    <div className="text-3xl mb-3">ğŸ¬</div>
                    <h3 className="font-bold text-white text-lg mb-2">This Month</h3>
                    <p className="text-white/90 font-comic text-sm">
                      Study your comedy heroes and practice their techniques for 10 minutes daily.
                    </p>
                  </div>
                  <div className="p-6 rounded-3xl bg-gradient-to-br from-purple-500/20 to-pink-600/20 backdrop-blur-sm border border-white/20">
                    <div className="text-3xl mb-3">ğŸ†</div>
                    <h3 className="font-bold text-white text-lg mb-2">Level Up</h3>
                    <p className="text-white/90 font-comic text-sm">
                      Challenge yourself to try your opposite style in low-stakes situations.
                    </p>
                  </div>
                </div>
              </div>

              <div className="p-8 rounded-3xl bg-gradient-to-br from-indigo-500/20 to-purple-600/20 backdrop-blur-sm border border-white/20 mb-8">
                <div className="text-center mb-6">
                  <h2 className="text-3xl font-bungee text-white mb-2">{code.split("").join("")} â€” {profile.title}</h2>
                  <p className="text-lg font-comic text-white/90 mb-6">{profile.subtitle}</p>
                </div>
                
                <div className="grid md:grid-cols-2 gap-8">
                  <div>
                    <h3 className="font-bold text-xl text-white mb-4 flex items-center gap-2">
                      ğŸš€ Growth Tips
                    </h3>
                    <ul className="space-y-3">
                      {profile.growth.map((g, i) => (
                        <li key={i} className="text-white/90 font-comic flex items-start gap-3">
                          <span className="text-yellow-300 text-xl">âœ¨</span>
                          <span>{g}</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                  
                  <div>
                    <h3 className="font-bold text-xl text-white mb-4 flex items-center gap-2">
                      ğŸ‘‘ Kindred Comedy Spirits
                    </h3>
                    <div className="space-y-2">
                      {profile.examples.map((example, i) => (
                        <div key={i} className="bg-white/10 p-3 rounded-2xl text-white/90 font-comic flex items-center gap-2">
                          <span className="text-2xl">ğŸ­</span>
                          <span>{example}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>

              <div className="p-8 rounded-3xl bg-gradient-to-br from-orange-500/20 to-red-600/20 backdrop-blur-sm border border-white/20 mb-10">
                <h3 className="font-bold text-2xl text-white mb-4 text-center flex items-center justify-center gap-3">
                  ğŸ”„ Your Comedy Opposite
                </h3>
                <div className="text-center">
                  <div className="inline-flex items-center gap-3 px-8 py-4 rounded-3xl bg-gradient-to-r from-gray-700 to-black text-white text-2xl font-bungee shadow-2xl pulse-glow mb-4">
                    <span>ğŸ­</span>
                    <span>{opposite.split("").join(" - ")}</span>
                    <span>ğŸª</span>
                  </div>
                  <p className="text-lg font-comic text-white/90 leading-relaxed">
                    Try a 24â€‘hour challenge where you imitate your opposite's style in small, safe ways. 
                    It stretches timing, targets, and toneâ€”like comedy cross-training! ğŸ’ªğŸ˜„
                  </p>
                </div>
              </div>

              <div className="flex flex-wrap gap-4 justify-center mb-8">
                <button onClick={onRetake} className="px-8 py-4 rounded-2xl bg-white/20 backdrop-blur-sm text-white font-bold hover:bg-white/30 transition-all button-hover inline-flex items-center gap-3">
                  <RotateCcwIcon /> ğŸ”„ Take Quiz Again!
                </button>
                <button
                  onClick={() => {
                    const url = typeof window !== 'undefined' ? window.location.href : '';
                    const shareText = `ğŸ‰ I just discovered my comedy DNA! I'm a ${code.split("").join("")} â€” ${profile.title}! ğŸ­âœ¨ 

This quiz revealed exactly why I find certain things funny and gave me personalized tips to level up my humor game! 

#HumorCode #ComedyDNA #HCODE

Find your funny at: ${url}`;
                    navigator.clipboard?.writeText(shareText);
                    alert("ğŸŠ Share text copied to clipboard! Spread the laughter! ğŸ˜„");
                  }}
                  className="px-8 py-4 rounded-2xl bg-gradient-to-r from-green-400 to-blue-500 text-white font-bold hover:scale-105 transition-transform button-hover inline-flex items-center gap-3 shadow-2xl pulse-glow"
                >
                  <Share2Icon /> ğŸ“¢ Share My Comedy DNA!
                </button>
                <div className="w-full flex flex-wrap justify-center gap-3 mt-3">
                  <button
                    onClick={() => {
                      const pageUrl = encodeURIComponent(window.location.href);
                      const text = encodeURIComponent(`I discovered my comedy DNA (Build ${APP_VERSION})! I'm a ${code.split("").join("")} â€” ${profile.title}! #HumorCode #HCODE`);
                      openShare(`https://www.facebook.com/sharer/sharer.php?u=${pageUrl}&quote=${text}`);
                    }}
                    className="px-5 py-2 rounded-2xl bg-blue-600 text-white font-bold button-hover"
                    title="Share on Facebook"
                  >
                    Share on Facebook
                  </button>
                  <button
                    onClick={() => {
                      const pageUrl = encodeURIComponent(window.location.href);
                      const text = encodeURIComponent(`I discovered my comedy DNA (Build ${APP_VERSION})! I'm a ${code.split("").join("")} â€” ${profile.title}!`);
                      openShare(`https://twitter.com/intent/tweet?text=${text}&url=${pageUrl}&hashtags=HumorCode,HCODE`);
                    }}
                    className="px-5 py-2 rounded-2xl bg-black text-white font-bold button-hover"
                    title="Share on X/Twitter"
                  >
                    Share on X
                  </button>
                  <button
                    onClick={() => {
                      const pageUrl = encodeURIComponent(window.location.href);
                      openShare(`https://www.linkedin.com/sharing/share-offsite/?url=${pageUrl}`);
                    }}
                    className="px-5 py-2 rounded-2xl bg-sky-700 text-white font-bold button-hover"
                    title="Share on LinkedIn"
                  >
                    Share on LinkedIn
                  </button>
                </div>
              </div>
              
              {/* Value reinforcement */}
              <div className="text-center mb-6">
                <div className="bg-gradient-to-r from-yellow-400/20 to-orange-500/20 backdrop-blur-sm p-6 rounded-3xl border border-white/20">
                  <div className="text-2xl mb-3">ğŸ’ What You Just Discovered</div>
                  <div className="grid md:grid-cols-2 gap-4 text-left">
                    <div className="flex items-start gap-3">
                      <span className="text-2xl">ğŸ§¬</span>
                      <div>
                        <div className="font-bold text-white">Your Unique Comedy Profile</div>
                        <div className="text-white/80 text-sm font-comic">Most people never understand why they're funny - you now do!</div>
                      </div>
                    </div>
                    <div className="flex items-start gap-3">
                      <span className="text-2xl">ğŸ¯</span>
                      <div>
                        <div className="font-bold text-white">Personalized Growth Plan</div>
                        <div className="text-white/80 text-sm font-comic">Specific, actionable steps to become even funnier</div>
                      </div>
                    </div>
                    <div className="flex items-start gap-3">
                      <span className="text-2xl">ğŸ­</span>
                      <div>
                        <div className="font-bold text-white">Comedy Role Models</div>
                        <div className="text-white/80 text-sm font-comic">Learn from comedians who share your exact style</div>
                      </div>
                    </div>
                    <div className="flex items-start gap-3">
                      <span className="text-2xl">ğŸ”</span>
                      <div>
                        <div className="font-bold text-white">Deep Self-Understanding</div>
                        <div className="text-white/80 text-sm font-comic">Know exactly what makes you tick (and what makes you laugh!)</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        }

        // Main App Component
        function HumorCodeQuizApp() {
          const [step, setStep] = useState("intro");
          const [answers, setAnswers] = useState({});
          const [result, setResult] = useState(null);
          const [reducedMotion, setReducedMotion] = useState(false);

          const totalAnswered = Object.keys(answers).length;

          const handleSubmit = () => {
            if (Object.keys(answers).length < ITEMS.length) {
              if (!confirm("You haven't answered every item. Score anyway?")) return;
            }
            const scored = computeScores(answers);
            setResult(scored);
            setStep("result");
          };

          // helper: open share window
          const openShare = (url) => {
            const w = 700, h = 600;
            const y = window.top.outerHeight / 2 + window.top.screenY - ( h / 2);
            const x = window.top.outerWidth / 2 + window.top.screenX - ( w / 2);
            window.open(url, '_blank', `toolbar=0,status=0,width=${w},height=${h},top=${y},left=${x}`);
          };

          return (
            <div className={`min-h-screen bg-fun-gradient text-white font-fun ${reducedMotion ? 'reduce-motion' : ''}`}
                 data-app-version={APP_VERSION}>
              <div className="max-w-4xl mx-auto p-6">
                {step === "intro" && (
                  <section className="text-center fade-in">
                    <div className="mb-2 flex items-center justify-center gap-3 text-sm text-white/70">
                      <span className="px-2 py-0.5 rounded-full bg-white/10 border border-white/20">Build {APP_VERSION}</span>
                      <button onClick={() => setReducedMotion(r => !r)} className="px-2 py-0.5 rounded-full bg-white/10 border border-white/20 button-hover">
                        {reducedMotion ? 'Enable Animations' : 'Reduce Motion'}
                      </button>
                    </div>
                    <div className="mb-6 text-6xl float" aria-hidden="true">ğŸ¤£</div>
                    <h1 className="text-6xl font-bungee tracking-tight mb-4 pulse-glow text-white drop-shadow-lg">
                      Hâ€‘CODE Humor Quiz
                    </h1>
                    <div className="text-4xl mb-6">ğŸ§¬ What's Your Comedy DNA? ğŸ­</div>
                    
                    {/* Hook them with compelling benefits */}
                    <div className="bg-white/10 backdrop-blur-sm p-6 rounded-3xl mb-6 max-w-4xl mx-auto">
                      <div className="text-2xl font-bold text-yellow-300 mb-3">ğŸ¯ Ever Wonder Why Some Jokes Land and Others Don't?</div>
                      <p className="text-xl font-comic text-white/90 leading-relaxed mb-4">
                        Stop guessing! This scientifically-designed quiz reveals your unique comedy blueprint - the exact combination of traits that makes YOU funny.
                      </p>
                      <div className="grid md:grid-cols-3 gap-4 text-left">
                        <div className="bg-white/10 p-4 rounded-2xl">
                          <div className="text-2xl mb-2">ğŸª</div>
                          <div className="font-bold text-white mb-1">Know Your Strengths</div>
                          <div className="text-sm text-white/80">Discover exactly what makes you naturally funny</div>
                        </div>
                        <div className="bg-white/10 p-4 rounded-2xl">
                          <div className="text-2xl mb-2">ğŸš€</div>
                          <div className="font-bold text-white mb-1">Level Up Your Humor</div>
                          <div className="text-sm text-white/80">Get personalized tips to become even funnier</div>
                        </div>
                        <div className="bg-white/10 p-4 rounded-2xl">
                          <div className="text-2xl mb-2">ğŸ­</div>
                          <div className="font-bold text-white mb-1">Understand Others</div>
                          <div className="text-sm text-white/80">Learn why different people find different things funny</div>
                        </div>
                      </div>
                    </div>
                    
                    <div className="text-lg text-yellow-300 font-bold mb-2">
                      âš¡ Join 10,000+ people who've discovered their comedy code!
                    </div>
                    <div className="text-md text-white/80 mb-6">
                      24 scientifically-crafted questions â€¢ 5 minutes â€¢ Instant detailed results â±ï¸âœ¨
                    </div>
                    <div className="mt-8 inline-flex gap-3">
                      <button onClick={() => setStep("quiz")} className="px-8 py-4 rounded-3xl bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 text-white font-bold text-lg hover:scale-105 transition-transform button-hover inline-flex items-center gap-3 shadow-2xl pulse-glow">
                        ğŸš€ Start the Fun! <ArrowRightIcon />
                      </button>
                    </div>
                    <div className="mt-12 grid md:grid-cols-2 lg:grid-cols-4 gap-4 text-left max-w-4xl mx-auto">
                      {AXES.map((ax, idx) => (
                        <div key={ax.key} className="p-4 rounded-2xl bg-white/10 backdrop-blur-sm border border-white/20 hover:bg-white/20 transition-all" style={{animationDelay: `${idx * 0.1}s`}}>
                          <div className="font-bold text-lg mb-2 text-white">{ax.label}</div>
                          <div className="text-white/90 text-sm space-y-1">
                            <div className="bg-white/10 p-2 rounded-lg">{ax.letters[0]} â€” {ax.poles[ax.letters[0]]}</div>
                            <div className="text-center text-white/60">vs</div>
                            <div className="bg-white/10 p-2 rounded-lg">{ax.letters[1]} â€” {ax.poles[ax.letters[1]]}</div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </section>
                )}

                {step === "quiz" && (
                  <section className="fade-in">
                    <div className="text-center mb-8">
                      <div className="text-4xl mb-2">ğŸª</div>
                      <h2 className="text-4xl font-bungee text-white mb-2">Let's Find Your Funny! ğŸ­</h2>
                      <div className="text-xl font-comic text-white/90">
                        {totalAnswered === 0 && "Ready to discover what makes you tick? ğŸ˜„"}
                        {totalAnswered > 0 && totalAnswered < 12 && "You're getting warmed up! Keep going! ğŸ”¥"}
                        {totalAnswered >= 12 && totalAnswered < 24 && "Halfway there! You're on fire! ğŸš€"}
                        {totalAnswered === 24 && "All done! Time to see your comedy DNA! ğŸ§¬âœ¨"}
                      </div>
                      <div className="mt-4 bg-white/20 rounded-full h-4 overflow-hidden">
                        <div 
                          className="progress-bar h-full transition-all duration-1000" 
                          style={{width: `${(totalAnswered / ITEMS.length) * 100}%`}}
                        ></div>
                      </div>
                      <div className="text-white/80 mt-2 font-bold">{totalAnswered}/{ITEMS.length} questions answered ({Math.round((totalAnswered / ITEMS.length) * 100)}%)</div>
                    </div>
                    <div className="space-y-6">
                      {ITEMS.map((item, idx) => (
                        <div key={item.id} className="p-6 rounded-3xl bg-white/10 backdrop-blur-sm border border-white/20 hover:bg-white/15 transition-all quiz-transition flex flex-col md:flex-row md:items-center gap-4">
                          <div className="md:w-2/3">
                            <div className="flex items-center gap-2 mb-3">
                              <div className="text-2xl">{idx < 6 ? 'ğŸ¯' : idx < 12 ? 'ğŸ’' : idx < 18 ? 'ğŸ§ ' : 'ğŸ­'}</div>
                              <div className="text-sm font-bold text-white/80 bg-white/20 px-3 py-1 rounded-full">
                                Q{idx + 1} â€¢ {item.axis}
                              </div>
                            </div>
                            <div className="text-white font-comic text-lg leading-relaxed">{item.text}</div>
                          </div>
                          <div className="md:w-1/3 flex md:justify-end">
                            <Likert
                              value={answers[item.id]}
                              onChange={(v) => setAnswers((a) => ({ ...a, [item.id]: v }))}
                            />
                          </div>
                        </div>
                      ))}
                    </div>
                    <div className="flex flex-col sm:flex-row items-center justify-between mt-10 gap-4">
                      <button onClick={() => { setAnswers({}); setStep("intro"); }} className="px-6 py-3 rounded-2xl bg-white/20 text-white font-bold hover:bg-white/30 transition-all button-hover">
                        ğŸ”™ Back to Start
                      </button>
                      <button onClick={handleSubmit} className="px-8 py-4 rounded-3xl bg-gradient-to-r from-green-400 via-blue-500 to-purple-500 text-white font-bold text-lg hover:scale-105 transition-transform button-hover inline-flex items-center gap-3 shadow-2xl pulse-glow">
                        ğŸ‰ Reveal My Comedy DNA! <CheckIcon />
                      </button>
                    </div>
                  </section>
                )}

                {step === "result" && result && (
                  <section className="fade-in">
                    <div className="text-center mb-8">
                      <div className="text-6xl mb-4 float">ğŸŠ</div>
                      <h2 className="text-4xl font-bungee text-white mb-2">Your Comedy DNA Revealed! ğŸ§¬</h2>
                      <div className="text-xl font-comic text-white/90">
                        Drumroll please... ğŸ¥âœ¨ â€¢ Build {APP_VERSION}
                      </div>
                    </div>
                    <ResultView code={result.code} detail={result.detail} onRetake={() => { setAnswers({}); setResult(null); setStep("quiz"); }} />
                  </section>
                )}

                <footer className="text-center text-sm text-white/60 mt-12 pb-6 font-comic">
                  Build {APP_VERSION} â€¢ When sharing feedback, please include the build number. ğŸ™
                  <div className="mt-1">Made with ğŸ’– and lots of ğŸ˜‚ â€¢ Â© {new Date().getFullYear()} Hâ€‘CODE â€¢ Humor Typology</div>
                </footer>
              </div>
            </div>
          );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<HumorCodeQuizApp />);
    </script>
</body>
</html>
